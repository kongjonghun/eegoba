<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="lgcns.eegoba.api.review.mapper.ReviewMapper">

    <select id="getReviewCount" resultType="int">
        SELECT COUNT(*)
          FROM TB_REVIEW
         WHERE USE_YN = 'Y'
    </select>

    <select id="getReviewList" resultType="ReviewVO">
        SELECT REVIEW_ID
             , TYPE
             , BOOK_ID
             , LECTURE_ID
             , USER_ID
             , CONTENT
             , IS_RECOMMEND
             , CREATED_AT
             , UPDATED_AT
          FROM TB_REVIEW
        WHERE USE_YN = 'Y'
    </select>

    <select id="getReviewById" resultType="ReviewVO">
        SELECT REVIEW_ID
             , TYPE
             , BOOK_ID
             , LECTURE_ID
             , USER_ID
             , CONTENT
             , IS_RECOMMEND
             , CREATED_AT
             , UPDATED_AT
          FROM TB_REVIEW
         WHERE REVIEW_ID = #{reviewId}
           AND USE_YN = 'Y'
    </select>

    <select id="getReviewListByUserId" resultType="ReviewVO">
        SELECT REVIEW_ID
             , TYPE
             , BOOK_ID
             , LECTURE_ID
             , USER_ID
             , CONTENT
             , IS_RECOMMEND
             , CREATED_AT
             , UPDATED_AT
          FROM TB_REVIEW
         WHERE USER_ID = #{userId}
           AND USE_YN = 'Y'
    </select>

    <insert id="insertReview" parameterType="ReviewVO">
        INSERT INTO TB_REVIEW (
           TYPE
            , BOOK_ID
            , LECTURE_ID
            , USER_ID
            , CONTENT
            , IS_RECOMMEND
            , CREATED_AT
            , UPDATED_AT
            , USE_YN)
        VALUES (
            #{type}
            , #{bookId}
            , #{lectureId}
            , #{userId}
            , #{content}
            , #{isRecommend}
            , #{createdAt}
            , #{updatedAt}
            , 'Y')
    </insert>

    <update id="updateReview" parameterType="ReviewVO">
        UPDATE TB_REVIEW
           SET TYPE = #{type}
             , BOOK_ID = #{bookId}
             , LECTURE_ID = #{lectureId}
             , CONTENT = #{content}
             , IS_RECOMMEND = #{isRecommend}
             , UPDATED_AT = #{updatedAt}
         WHERE REVIEW_ID = #{reviewId}
    </update>

    <update id="deleteReview">
        UPDATE TB_REVIEW
           SET UPDATED_AT = #{updatedAt}
             , USE_YN = 'N'
         WHERE REVIEW_ID = #{reviewId}
    </update>
</mapper>